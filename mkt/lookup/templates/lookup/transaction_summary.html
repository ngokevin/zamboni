{% extends 'lookup/base.html' %}

{% block breadcrumbs %}
{% endblock %}

{% block content %}
  {% include 'lookup/includes/transaction_search.html' %}

  <section class="island c">
    <h1>
      {% trans tx_url = url('lookup.transaction_summary', tx_id) %}
        Transaction Lookup results for <a href="{{ tx_url }}">Transaction {{ tx_id }}</a>
      {% endtrans %}
    </h1>

    {% if tx %}
      <section id="prose">
        <dl>
          <dt>{{ _('Transaction ID') }}</dt><dd>{{ tx.uuid }}</dd>
          <dt>{{ _('Date') }}</dt><dd>{{ tx.created }}</dd>
          <dt>{{ _('Type') }}</dt><dd>{{ type }}</dd>
          <dt>{{ _('Buyer') }}</dt><dd>{{ buyer.uuid }} ({{ emaillink(contrib.user.email) }})</dd>
          <dt>{{ _('Seller') }}</dt><dd>{{ seller.uuid }}</dd>
          <dt>{{ _('Provider') }}</dt><dd>{{ provider }}</dd>
          <dt>{{ _('Price Tier') }}</dt><dd>{{ contrib.price_tier }}</dd>
          {% if related_tx %}
            <dt>{{ _('Related Transaction') }}</dt>
            <dd>
              <a href="{{ url('lookup.transaction_summary', related_tx.uuid) }}">
                {{ related_tx.uuid }}
              </a>
            </dd>
          {% endif %}
        </dl>
      </section>
    {% else %}
      {{ no_results() }}
    {% endif %}

    {% if action_allowed('Transaction', 'Refund') and not is_refund %}
      <form class="refund-transaction" method="post"
            action="{{ url('lookup.transaction_refund', tx_id) }}">
        {{ csrf() }}
        <label for="refund-reason">{{ _('Enter refund details to refund transaction') }}</label>
        <textarea id="refund-reason" name="refund_reason" rows=4></textarea>
        <button>{{ _('Refund this Transaction') }}</button>
      </form>
    {% endif %}

{% endblock %}
