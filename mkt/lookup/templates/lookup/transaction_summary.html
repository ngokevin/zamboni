{% extends 'lookup/base.html' %}

{% block breadcrumbs %}
{% endblock %}

{% block content %}
  {% include 'lookup/includes/transaction_search.html' %}

  <section class="island c">
    <h1>
      {% trans tx_url = url('lookup.transaction_summary', tx_id) %}
        Transaction Lookup results for <a href="{{ tx_url }}">Transaction {{ tx_id }}</a>
      {% endtrans %}
    </h1>

    {% if tx %}
      <section id="prose">
        <dl>
          <dt>{{ _('Transaction ID') }}</dt>
          <dd>{{ tx.id }}</dd>
          <dt>{{ _('Date') }}</dt>
          <dd>{{ tx.date }}</dd>
          {% if tx.buyer %}
            <dt>{{ _('Buyer') }}</dt>
            <dd>{{ tx.buyer|user_link }}</dd>
          {% endif %}
          {% if tx.seller %}
            <dt>{{ _('Seller') }}</dt>
            <dd>{{ tx.seller|user_link }}</dd>
          {% endif %}
          <dt>{{ _('Amount') }}</dt>
          <dd>{{ tx.amount|numberfmt }}</dd>
          <dt>{{ _('Notes') }}</dt><dd>{{ tx.notes }}</dd>
        </dl>
      </section>
    {% else %}
      {{ no_results() }}
    {% endif %}

    {% if action_allowed('Transaction', 'Refund') %}
      <form class="refund-transaction" method="post"
            action="{{ url('lookup.transaction_refund', tx_id) }}">
        {{ csrf() }}
        <label for="refund-reason">{{ _('Enter refund details to refund transaction') }}</label>
        <textarea id="refund-reason" name="refund_reason" rows=4></textarea>
        <button>{{ _('Refund this Transaction') }}</button>
      </form>
    {% endif %}

{% endblock %}
